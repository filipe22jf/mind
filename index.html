<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MindMed - Cronograma de Estudos</title>
    
    <!-- PWA Configuration -->
    <link rel="manifest" href="manifest.json">
    <meta name="theme-color" content="#0f172a">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <meta name="apple-mobile-web-app-title" content="MindMed">
    <link rel="apple-touch-icon" href="icon-192.png">
    <link rel="icon" type="image/png" sizes="192x192" href="icon-192.png">
    <link rel="icon" type="image/png" sizes="512x512" href="icon-512.png">
    
    <script src="https://unpkg.com/@supabase/supabase-js@2"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            /* MindMed Color Palette */
            --bg-primary: #0f172a;
            --bg-secondary: #1e293b;
            --bg-card: #334155;
            --text-primary: #ffffff;
            --text-secondary: #94a3b8;
            --border-color: #475569;
            --accent-color: #10b981;
            --accent-hover: #059669;
            --progress-color: #10b981;
            --error-color: #ef4444;
            --warning-color: #f59e0b;
            --info-color: #3b82f6;
            --success-color: #10b981;
            --shadow: 0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1);
            --shadow-lg: 0 10px 15px -3px rgb(0 0 0 / 0.1), 0 4px 6px -4px rgb(0 0 0 / 0.1);
        }

        /* Light theme variables */
        [data-theme="light"] {
            --bg-primary: #ffffff;
            --bg-secondary: #f8fafc;
            --bg-card: #f1f5f9;
            --text-primary: #1e293b;
            --text-secondary: #64748b;
            --border-color: #cbd5e1;
            --accent-color: #10b981;
            --accent-hover: #059669;
            --progress-color: #10b981;
            --error-color: #ef4444;
            --warning-color: #f59e0b;
            --info-color: #3b82f6;
            --success-color: #10b981;
            --shadow: 0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1);
            --shadow-lg: 0 10px 15px -3px rgb(0 0 0 / 0.1), 0 4px 6px -4px rgb(0 0 0 / 0.1);
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background-color: var(--bg-primary);
            color: var(--text-primary);
            min-height: 100vh;
            overflow-x: hidden;
            transition: background-color 0.3s ease, color 0.3s ease;
        }

        /* Header */
        .header {
            background: var(--bg-primary);
            padding: 1rem 2rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 1px solid var(--border-color);
            position: sticky;
            top: 0;
            z-index: 100;
        }

        .header-left {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .menu-toggle {
            background: none;
            border: none;
            color: var(--text-primary);
            font-size: 1.5rem;
            cursor: pointer;
            padding: 0.5rem;
            border-radius: 0.5rem;
            transition: all 0.3s ease;
        }

        .menu-toggle:hover {
            background-color: var(--bg-secondary);
            transform: scale(1.1);
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--text-primary);
            text-decoration: none;
        }

        .logo-icon {
            width: 32px;
            height: 32px;
            background: linear-gradient(135deg, #10b981, #059669);
            border-radius: 0.5rem;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
        }

        .header-right {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .theme-toggle, .help-btn {
            background: none;
            border: none;
            color: var(--accent-color);
            font-size: 1.25rem;
            cursor: pointer;
            padding: 0.5rem;
            border-radius: 50%;
            transition: all 0.3s ease;
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .theme-toggle:hover, .help-btn:hover {
            background-color: var(--bg-secondary);
            transform: scale(1.1);
        }

        /* Progress Bar */
        .progress-container {
            background: var(--bg-secondary);
            padding: 1rem 2rem;
            border-bottom: 1px solid var(--border-color);
        }

        .progress-info {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 0.5rem;
        }

        .progress-label {
            color: var(--warning-color);
            font-weight: 600;
            font-size: 0.875rem;
        }

        .progress-count {
            color: var(--text-secondary);
            font-size: 0.875rem;
        }

        .progress-bar {
            width: 100%;
            height: 8px;
            background: var(--bg-primary);
            border-radius: 4px;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: var(--progress-color);
            border-radius: 4px;
            transition: width 0.3s ease;
            width: 82%;
        }

        /* Sidebar */
        .sidebar {
            position: fixed;
            left: -280px;
            top: 0;
            width: 280px;
            height: 100vh;
            background: var(--bg-secondary);
            border-right: 1px solid var(--border-color);
            transition: all 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94);
            z-index: 200;
            overflow-y: auto;
            backdrop-filter: blur(10px);
        }

        .sidebar.open {
            left: 0;
            box-shadow: var(--shadow-lg);
        }

        .sidebar-header {
            padding: 2rem 1.5rem 1rem;
            border-bottom: 1px solid var(--border-color);
        }

        .user-profile {
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }

        .user-avatar {
            width: 40px;
            height: 40px;
            background: var(--accent-color);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: 600;
        }

        .user-info h3 {
            font-size: 0.875rem;
            font-weight: 600;
            color: var(--text-primary);
        }

        .user-info p {
            font-size: 0.75rem;
            color: var(--text-secondary);
        }

        .sidebar-nav {
            padding: 1rem 0;
        }

        .nav-item {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            padding: 0.75rem 1.5rem;
            color: var(--text-secondary);
            text-decoration: none;
            transition: all 0.3s ease;
            border-left: 3px solid transparent;
            position: relative;
            overflow: hidden;
        }

        .nav-item::before {
            content: '';
            position: absolute;
            left: 0;
            top: 0;
            width: 0;
            height: 100%;
            background: linear-gradient(90deg, var(--accent-color), transparent);
            transition: width 0.3s ease;
            z-index: -1;
        }

        .nav-item:hover::before, .nav-item.active::before {
            width: 100%;
        }

        .nav-item:hover, .nav-item.active {
            background: rgba(16, 185, 129, 0.1);
            color: var(--text-primary);
            border-left-color: var(--accent-color);
            transform: translateX(5px);
        }

        .nav-icon {
            width: 20px;
            height: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        /* Main Content */
        .main-container {
            display: flex;
            min-height: calc(100vh - 140px);
        }

        .content {
            flex: 1;
            padding: 2rem;
            max-width: 1200px;
            margin: 0 auto;
        }

        /* Weekly Schedule */
        .schedule-container {
            background: var(--bg-secondary);
            border-radius: 1rem;
            padding: 2rem;
            margin-bottom: 2rem;
            border: 1px solid var(--border-color);
            position: relative;
            overflow: hidden;
        }

        .schedule-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 2rem;
        }

        .week-progress {
            background: var(--info-color);
            color: white;
            padding: 0.5rem 1rem;
            border-radius: 2rem;
            font-size: 0.875rem;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .schedule-title {
            font-size: 1.25rem;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 0.5rem;
        }

        .schedule-subtitle {
            color: var(--text-secondary);
            font-size: 0.875rem;
        }

        /* Gesture Navigation */
        .gesture-container {
            position: relative;
            overflow: hidden;
            border-radius: 1rem;
            touch-action: pan-x;
        }

        .schedule-content {
            display: flex;
            transition: transform 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94);
            will-change: transform;
        }

        .day-section {
            min-width: 100%;
            padding: 1rem;
            background: var(--bg-primary);
            border-radius: 0.75rem;
            margin-right: 1rem;
            border: 1px solid var(--border-color);
        }

        .day-header {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            margin-bottom: 1.5rem;
            padding-bottom: 1rem;
            border-bottom: 1px solid var(--border-color);
        }

        .day-number {
            width: 32px;
            height: 32px;
            background: var(--info-color);
            color: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
            font-size: 0.875rem;
        }

        .day-name {
            font-size: 1.125rem;
            font-weight: 600;
            color: var(--text-primary);
        }

        .topic-item {
            display: flex;
            align-items: center;
            gap: 1rem;
            padding: 1rem;
            background: var(--bg-card);
            border-radius: 0.75rem;
            margin-bottom: 1rem;
            border: 1px solid var(--border-color);
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .topic-item:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-lg);
            border-color: var(--accent-color);
        }

        .topic-checkbox {
            width: 20px;
            height: 20px;
            border: 2px solid var(--border-color);
            border-radius: 4px;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
        }

        .topic-checkbox.checked {
            background: var(--accent-color);
            border-color: var(--accent-color);
            color: white;
        }

        .topic-info {
            flex: 1;
        }

        .topic-title {
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 0.25rem;
        }

        .topic-meta {
            display: flex;
            align-items: center;
            gap: 1rem;
            font-size: 0.75rem;
            color: var(--text-secondary);
        }

        .topic-category {
            background: var(--info-color);
            color: white;
            padding: 0.25rem 0.5rem;
            border-radius: 1rem;
            font-size: 0.75rem;
            font-weight: 500;
        }

        .topic-category.clinica-medica {
            background: var(--info-color);
        }

        .topic-category.cardiologia {
            background: var(--error-color);
        }

        /* Navigation Indicators */
        .nav-indicators {
            display: flex;
            justify-content: center;
            gap: 0.5rem;
            margin-top: 1.5rem;
        }

        .nav-dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: var(--border-color);
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .nav-dot.active {
            background: var(--accent-color);
            transform: scale(1.5);
        }

        /* Gesture Hints */
        .gesture-hint {
            position: absolute;
            bottom: 1rem;
            right: 1rem;
            background: rgba(16, 185, 129, 0.1);
            color: var(--accent-color);
            padding: 0.5rem 1rem;
            border-radius: 2rem;
            font-size: 0.75rem;
            border: 1px solid var(--accent-color);
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 0.7; }
            50% { opacity: 1; }
        }

        /* Overlay */
        .overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            z-index: 150;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s ease;
            backdrop-filter: blur(5px);
        }

        .overlay.active {
            opacity: 1;
            visibility: visible;
        }

        /* Responsive */
        @media (max-width: 768px) {
            .header {
                padding: 1rem;
            }

            .content {
                padding: 1rem;
            }

            .progress-container {
                padding: 1rem;
            }

            .schedule-container {
                padding: 1rem;
            }

            .day-section {
                padding: 0.75rem;
            }
        }

        /* Loading States */
        .loading {
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 200px;
        }

        .spinner {
            width: 40px;
            height: 40px;
            border: 3px solid var(--border-color);
            border-top: 3px solid var(--accent-color);
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* Hidden by default */
        .hidden {
            display: none;
        }
    </style>
</head>
<body>
    <!-- Header -->
    <header class="header">
        <div class="header-left">
            <button class="menu-toggle" onclick="toggleSidebar()">‚ò∞</button>
            <a href="#" class="logo">
                <div class="logo-icon">M</div>
                MindMed
            </a>
        </div>
        <div class="header-right">
            <button class="theme-toggle" onclick="toggleTheme()">üåô</button>
            <button class="help-btn" onclick="showHelp()">?</button>
        </div>
    </header>

    <!-- Progress Bar -->
    <div class="progress-container">
        <div class="progress-info">
            <span class="progress-label">Progresso da Semana 1</span>
            <span class="progress-count">0%</span>
        </div>
        <div class="progress-bar">
            <div class="progress-fill" style="width: 0%"></div>
        </div>
    </div>

    <!-- Sidebar -->
    <nav class="sidebar" id="sidebar">
        <div class="sidebar-header">
            <div class="user-profile">
                <div class="user-avatar">LA</div>
                <div class="user-info">
                    <h3>Lucas Augusto</h3>
                    <p>Estudante</p>
                </div>
            </div>
        </div>
        <div class="sidebar-nav">
            <a href="#" class="nav-item active">
                <span class="nav-icon">üè†</span>
                Dashboard
            </a>
            <a href="#" class="nav-item" id="logout-btn">
                <span class="nav-icon">üö™</span>
                Sair
            </a>
        </div>
    </nav>

    <!-- Overlay -->
    <div class="overlay" id="overlay" onclick="closeSidebar()"></div>

    <!-- Main Content -->
    <div class="main-container">
        <main class="content">
            <div class="schedule-container">
                <div class="schedule-header">
                    <div>
                        <div class="schedule-title">Cronograma da Semana 1</div>
                        <div class="schedule-subtitle">Marque os temas conforme voc√™ os estuda</div>
                    </div>
                    <div class="week-progress">
                        üìä 0 de 14 temas conclu√≠dos
                    </div>
                </div>

                <div class="gesture-container">
                    <div class="schedule-content" id="scheduleContent">
                        <!-- Segunda-feira -->
                        <div class="day-section">
                            <div class="day-header">
                                <div class="day-number">1</div>
                                <div class="day-name">Segunda-feira</div>
                            </div>
                            
                            <div class="topic-item" onclick="toggleTopic(this)">
                                <div class="topic-checkbox">
                                    <span style="display: none;">‚úì</span>
                                </div>
                                <div class="topic-info">
                                    <div class="topic-title">Hipertens√£o Arterial Sist√™mica</div>
                                    <div class="topic-meta">
                                        <span class="topic-category clinica-medica">Cl√≠nica M√©dica</span>
                                        <span>üìö 45 flashcards</span>
                                    </div>
                                </div>
                            </div>

                            <div class="topic-item" onclick="toggleTopic(this)">
                                <div class="topic-checkbox">
                                    <span style="display: none;">‚úì</span>
                                </div>
                                <div class="topic-info">
                                    <div class="topic-title">Diabetes Mellitus</div>
                                    <div class="topic-meta">
                                        <span class="topic-category clinica-medica">Cl√≠nica M√©dica</span>
                                        <span>üìö 52 flashcards</span>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Ter√ßa-feira -->
                        <div class="day-section">
                            <div class="day-header">
                                <div class="day-number">2</div>
                                <div class="day-name">Ter√ßa-feira</div>
                            </div>
                            
                            <div class="topic-item" onclick="toggleTopic(this)">
                                <div class="topic-checkbox">
                                    <span style="display: none;">‚úì</span>
                                </div>
                                <div class="topic-info">
                                    <div class="topic-title">Insufici√™ncia Card√≠aca</div>
                                    <div class="topic-meta">
                                        <span class="topic-category cardiologia">Cardiologia</span>
                                        <span>üìö 38 flashcards</span>
                                    </div>
                                </div>
                            </div>

                            <div class="topic-item" onclick="toggleTopic(this)">
                                <div class="topic-checkbox">
                                    <span style="display: none;">‚úì</span>
                                </div>
                                <div class="topic-info">
                                    <div class="topic-title">Pneumonia Comunit√°ria</div>
                                    <div class="topic-meta">
                                        <span class="topic-category clinica-medica">Cl√≠nica M√©dica</span>
                                        <span>üìö 41 flashcards</span>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Quarta-feira -->
                        <div class="day-section">
                            <div class="day-header">
                                <div class="day-number">3</div>
                                <div class="day-name">Quarta-feira</div>
                            </div>
                            
                            <div class="topic-item" onclick="toggleTopic(this)">
                                <div class="topic-checkbox">
                                    <span style="display: none;">‚úì</span>
                                </div>
                                <div class="topic-info">
                                    <div class="topic-title">Infarto Agudo do Mioc√°rdio</div>
                                    <div class="topic-meta">
                                        <span class="topic-category cardiologia">Cardiologia</span>
                                        <span>üìö 55 flashcards</span>
                                    </div>
                                </div>
                            </div>

                            <div class="topic-item" onclick="toggleTopic(this)">
                                <div class="topic-checkbox">
                                    <span style="display: none;">‚úì</span>
                                </div>
                                <div class="topic-info">
                                    <div class="topic-title">Asma Br√¥nquica</div>
                                    <div class="topic-meta">
                                        <span class="topic-category clinica-medica">Cl√≠nica M√©dica</span>
                                        <span>üìö 33 flashcards</span>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Quinta-feira -->
                        <div class="day-section">
                            <div class="day-header">
                                <div class="day-number">4</div>
                                <div class="day-name">Quinta-feira</div>
                            </div>
                            
                            <div class="topic-item" onclick="toggleTopic(this)">
                                <div class="topic-checkbox">
                                    <span style="display: none;">‚úì</span>
                                </div>
                                <div class="topic-info">
                                    <div class="topic-title">Arritmias Card√≠acas</div>
                                    <div class="topic-meta">
                                        <span class="topic-category cardiologia">Cardiologia</span>
                                        <span>üìö 47 flashcards</span>
                                    </div>
                                </div>
                            </div>

                            <div class="topic-item" onclick="toggleTopic(this)">
                                <div class="topic-checkbox">
                                    <span style="display: none;">‚úì</span>
                                </div>
                                <div class="topic-info">
                                    <div class="topic-title">Doen√ßa Renal Cr√¥nica</div>
                                    <div class="topic-meta">
                                        <span class="topic-category clinica-medica">Cl√≠nica M√©dica</span>
                                        <span>üìö 39 flashcards</span>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Sexta-feira -->
                        <div class="day-section">
                            <div class="day-header">
                                <div class="day-number">5</div>
                                <div class="day-name">Sexta-feira</div>
                            </div>
                            
                            <div class="topic-item" onclick="toggleTopic(this)">
                                <div class="topic-checkbox">
                                    <span style="display: none;">‚úì</span>
                                </div>
                                <div class="topic-info">
                                    <div class="topic-title">Hepatite Viral</div>
                                    <div class="topic-meta">
                                        <span class="topic-category clinica-medica">Cl√≠nica M√©dica</span>
                                        <span>üìö 42 flashcards</span>
                                    </div>
                                </div>
                            </div>

                            <div class="topic-item" onclick="toggleTopic(this)">
                                <div class="topic-checkbox">
                                    <span style="display: none;">‚úì</span>
                                </div>
                                <div class="topic-info">
                                    <div class="topic-title">S√≠ndrome Coronariana Aguda</div>
                                    <div class="topic-meta">
                                        <span class="topic-category cardiologia">Cardiologia</span>
                                        <span>üìö 51 flashcards</span>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- S√°bado -->
                        <div class="day-section">
                            <div class="day-header">
                                <div class="day-number">6</div>
                                <div class="day-name">S√°bado</div>
                            </div>
                            
                            <div class="topic-item" onclick="toggleTopic(this)">
                                <div class="topic-checkbox">
                                    <span style="display: none;">‚úì</span>
                                </div>
                                <div class="topic-info">
                                    <div class="topic-title">Revis√£o Geral - Cardiologia</div>
                                    <div class="topic-meta">
                                        <span class="topic-category cardiologia">Cardiologia</span>
                                        <span>üìö Revis√£o</span>
                                    </div>
                                </div>
                            </div>

                            <div class="topic-item" onclick="toggleTopic(this)">
                                <div class="topic-checkbox">
                                    <span style="display: none;">‚úì</span>
                                </div>
                                <div class="topic-info">
                                    <div class="topic-title">Revis√£o Geral - Cl√≠nica M√©dica</div>
                                    <div class="topic-meta">
                                        <span class="topic-category clinica-medica">Cl√≠nica M√©dica</span>
                                        <span>üìö Revis√£o</span>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Domingo -->
                        <div class="day-section">
                            <div class="day-header">
                                <div class="day-number">7</div>
                                <div class="day-name">Domingo</div>
                            </div>
                            
                            <div class="topic-item" onclick="toggleTopic(this)">
                                <div class="topic-checkbox">
                                    <span style="display: none;">‚úì</span>
                                </div>
                                <div class="topic-info">
                                    <div class="topic-title">Simulado Semanal</div>
                                    <div class="topic-meta">
                                        <span class="topic-category" style="background: var(--warning-color);">Avalia√ß√£o</span>
                                        <span>üìù 50 quest√µes</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="nav-indicators">
                        <div class="nav-dot active" onclick="goToDay(0)"></div>
                        <div class="nav-dot" onclick="goToDay(1)"></div>
                        <div class="nav-dot" onclick="goToDay(2)"></div>
                        <div class="nav-dot" onclick="goToDay(3)"></div>
                        <div class="nav-dot" onclick="goToDay(4)"></div>
                        <div class="nav-dot" onclick="goToDay(5)"></div>
                        <div class="nav-dot" onclick="goToDay(6)"></div>
                    </div>

                    <div class="gesture-hint">
                        üëà Deslize para navegar
                    </div>
                </div>
            </div>
        </main>
    </div>

    <script>
        // Supabase configuration
        const supabaseUrl = 'https://your-project.supabase.co';
        const supabaseKey = 'your-anon-key';
        const supabase = window.supabase.createClient(supabaseUrl, supabaseKey);

        // Global variables
        let currentDay = 0;
        let totalDays = 7;
        let completedTopics = 0;
        let totalTopics = 14;

        // Touch/gesture handling
        let startX = 0;
        let currentX = 0;
        let isDragging = false;

        const scheduleContent = document.getElementById('scheduleContent');

        scheduleContent.addEventListener('touchstart', handleTouchStart, { passive: true });
        scheduleContent.addEventListener('touchmove', handleTouchMove, { passive: true });
        scheduleContent.addEventListener('touchend', handleTouchEnd, { passive: true });

        scheduleContent.addEventListener('mousedown', handleMouseStart);
        scheduleContent.addEventListener('mousemove', handleMouseMove);
        scheduleContent.addEventListener('mouseup', handleMouseEnd);
        scheduleContent.addEventListener('mouseleave', handleMouseEnd);

        function handleTouchStart(e) {
            startX = e.touches[0].clientX;
            isDragging = true;
        }

        function handleTouchMove(e) {
            if (!isDragging) return;
            currentX = e.touches[0].clientX;
            const diffX = currentX - startX;
            
            if (Math.abs(diffX) > 10) {
                e.preventDefault();
            }
        }

        function handleTouchEnd(e) {
            if (!isDragging) return;
            isDragging = false;
            
            const diffX = currentX - startX;
            const threshold = 50;
            
            if (diffX > threshold && currentDay > 0) {
                goToDay(currentDay - 1);
            } else if (diffX < -threshold && currentDay < totalDays - 1) {
                goToDay(currentDay + 1);
            }
        }

        function handleMouseStart(e) {
            startX = e.clientX;
            isDragging = true;
            e.preventDefault();
        }

        function handleMouseMove(e) {
            if (!isDragging) return;
            currentX = e.clientX;
        }

        function handleMouseEnd(e) {
            if (!isDragging) return;
            isDragging = false;
            
            const diffX = currentX - startX;
            const threshold = 50;
            
            if (diffX > threshold && currentDay > 0) {
                goToDay(currentDay - 1);
            } else if (diffX < -threshold && currentDay < totalDays - 1) {
                goToDay(currentDay + 1);
            }
        }

        // Navigation functions
        function goToDay(dayIndex) {
            if (dayIndex < 0 || dayIndex >= totalDays) return;
            
            currentDay = dayIndex;
            const translateX = -dayIndex * 100;
            scheduleContent.style.transform = `translateX(${translateX}%)`;
            
            // Update navigation dots
            document.querySelectorAll('.nav-dot').forEach((dot, index) => {
                dot.classList.toggle('active', index === dayIndex);
            });
        }

        // Sidebar functions
        function toggleSidebar() {
            const sidebar = document.getElementById('sidebar');
            const overlay = document.getElementById('overlay');
            
            sidebar.classList.toggle('open');
            overlay.classList.toggle('active');
        }

        function closeSidebar() {
            const sidebar = document.getElementById('sidebar');
            const overlay = document.getElementById('overlay');
            
            sidebar.classList.remove('open');
            overlay.classList.remove('active');
        }

        // Topic functionality
        function toggleTopic(topicElement) {
            const checkbox = topicElement.querySelector('.topic-checkbox');
            const checkmark = checkbox.querySelector('span');
            
            checkbox.classList.toggle('checked');
            
            if (checkbox.classList.contains('checked')) {
                checkmark.style.display = 'block';
                completedTopics++;
            } else {
                checkmark.style.display = 'none';
                completedTopics--;
            }
            
            updateProgress();
        }

        function updateProgress() {
            const progressFill = document.querySelector('.progress-fill');
            const progressCount = document.querySelector('.progress-count');
            const weekProgress = document.querySelector('.week-progress');
            
            const percentage = (completedTopics / totalTopics) * 100;
            
            progressFill.style.width = percentage + '%';
            progressCount.textContent = Math.round(percentage) + '%';
            weekProgress.textContent = `üìä ${completedTopics} de ${totalTopics} temas conclu√≠dos`;
        }

        // Theme toggle functionality
        function toggleTheme() {
            const currentTheme = document.documentElement.getAttribute('data-theme');
            const themeToggleBtn = document.querySelector('.theme-toggle');
            
            if (currentTheme === 'light') {
                // Switch to dark theme
                document.documentElement.setAttribute('data-theme', 'dark');
                themeToggleBtn.textContent = 'üåô';
                localStorage.setItem('mindmed_theme', 'dark');
            } else {
                // Switch to light theme
                document.documentElement.setAttribute('data-theme', 'light');
                themeToggleBtn.textContent = '‚òÄÔ∏è';
                localStorage.setItem('mindmed_theme', 'light');
            }
        }

        // Initialize theme on page load
        function initializeTheme() {
            const savedTheme = localStorage.getItem('mindmed_theme');
            const themeToggleBtn = document.querySelector('.theme-toggle');
            
            if (savedTheme) {
                document.documentElement.setAttribute('data-theme', savedTheme);
                themeToggleBtn.textContent = savedTheme === 'light' ? '‚òÄÔ∏è' : 'üåô';
            } else {
                // Default to dark theme
                document.documentElement.setAttribute('data-theme', 'dark');
                themeToggleBtn.textContent = 'üåô';
                localStorage.setItem('mindmed_theme', 'dark');
            }
        }

        // Help function
        function showHelp() {
            alert('Ajuda: Deslize para navegar pelos dias da semana. Clique nos temas para marc√°-los como conclu√≠dos.');
        }

        // Initialize app
        document.addEventListener('DOMContentLoaded', function() {
            // Initialize theme first
            initializeTheme();
            
            // Check authentication status
            checkAuth();
            
            // Initialize schedule
            goToDay(0);
            updateProgress();
            
            // Hide gesture hint after 5 seconds
            setTimeout(() => {
                const hint = document.querySelector('.gesture-hint');
                if (hint) {
                    hint.style.opacity = '0';
                    setTimeout(() => hint.remove(), 300);
                }
            }, 5000);
        });

        async function checkAuth() {
            try {
                // Check for demo user in localStorage
                const demoUser = localStorage.getItem('mindmed_user');
                if (demoUser) {
                    // Update user info in sidebar if available
                    const userData = JSON.parse(demoUser);
                    updateUserInfo(userData);
                    return; // User is authenticated via demo
                }

                // Check Supabase auth (only if properly configured)
                if (supabaseUrl !== 'https://your-project.supabase.co' && supabaseKey !== 'your-anon-key') {
                    const { data: { user } } = await supabase.auth.getUser();
                    if (user) {
                        updateUserInfo(user);
                        return; // User is authenticated via Supabase
                    }
                }

                // No authentication found, redirect to login
                window.location.href = 'login.html';
            } catch (error) {
                console.error('Erro ao verificar autentica√ß√£o:', error);
                // Only redirect on authentication errors if no demo user exists
                const demoUser = localStorage.getItem('mindmed_user');
                if (!demoUser) {
                    window.location.href = 'login.html';
                }
            }
        }

        function updateUserInfo(user) {
            const userInfo = document.querySelector('.user-info h3');
            const userAvatar = document.querySelector('.user-avatar');
            
            if (user.user_metadata?.full_name) {
                userInfo.textContent = user.user_metadata.full_name;
                const initials = user.user_metadata.full_name
                    .split(' ')
                    .map(name => name[0])
                    .join('')
                    .toUpperCase()
                    .substring(0, 2);
                userAvatar.textContent = initials;
            }
        }

        // Logout function
        async function logout() {
            try {
                // Remove user data from localStorage
                localStorage.removeItem('mindmed_user');
                
                // Sign out from Supabase
                await supabase.auth.signOut();
                
                // Redirect to login page
                window.location.href = 'login.html';
            } catch (error) {
                console.error('Erro ao fazer logout:', error);
                // Even if there's an error, redirect to login
                window.location.href = 'login.html';
            }
        }

        // Add logout event listener using ID selector
        document.addEventListener('DOMContentLoaded', function() {
            const logoutBtn = document.getElementById('logout-btn');
            if (logoutBtn) {
                logoutBtn.addEventListener('click', function(e) {
                    e.preventDefault();
                    logout();
                });
            }
        });

        // Keyboard navigation
        document.addEventListener('keydown', function(e) {
            if (e.key === 'ArrowLeft' && currentDay > 0) {
                goToDay(currentDay - 1);
            } else if (e.key === 'ArrowRight' && currentDay < totalDays - 1) {
                goToDay(currentDay + 1);
            }
        });
    </script>
</body>
</html>

